# python_pipeline/tools/backup_and_restore/metadata.yml

# --- Basic Information ---
displayName: "Device Backup & Restore"
description: "A tool to perform configuration backups from a device or restore a configuration to a device. The form will dynamically change based on the selected action."
category: "Device Management"

# --- Capabilities ---
capabilities:
  deviceAuth: true
  enableReportSaving: false

# --- Parameters: This list defines the form fields in the UI ---
parameters:
  # --- This parameter will now be rendered in the sidebar ---
  - name: "command"
    label: "Action to Perform"
    type: "radio"
    required: true
    default: "backup"
    options:
      - { value: "backup", label: "Perform Backup" }
      - { value: "restore", label: "Perform Restore" }
    # FIX: Add this layout property to signal its location to the frontend.
    layout: "sidebar"
    description: "Choose whether to back up from or restore to the device."

  # --- Restore-specific parameters ---
  # These will remain in the main content area and will show/hide dynamically.
  - name: "backup_file"
    label: "Backup File to Restore"
    type: "text"
    required: true
    placeholder: "e.g., /app/python-scripts/backups/172.27.200.200_set.set"
    description: "Full path inside the container to the configuration file to be restored."
    show_if: { name: "command", value: "restore" }

  - name: "type"
    label: "Restore Load Type"
    type: "enum"
    default: "override"
    required: true
    options:
      - { value: "override", label: "Override (full replace)" }
      - { value: "set", label: "Set Commands" }
      - { value: "merge", label: "Merge" }
    description: "The method used to load the configuration onto the device."
    show_if: { name: "command", value: "restore" }

  - name: "confirmed_commit_timeout"
    label: "Confirmed Commit Timeout (minutes)"
    type: "number"
    default: 5
    description: "Timeout for confirmed commit. A value of 0 disables this safety feature."
    show_if: { name: "command", value: "restore" }
